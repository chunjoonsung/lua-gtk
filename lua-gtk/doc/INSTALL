
Contents:

  - Build Instructions for Linux
  - Build Instructions for MingW32


Build Instructions for Linux
============================

My system is Debian/testing, where most of the required libraries are available
as packages.  Prerequisites:

  - Gtk2 (tested with 2.6.8, 2.8.16, 2.10.13, 2.12.5) with devel files
  - libffi
  - lua5.1, liblua-bit, liblua5.1-expat
  - lua sockets - required for the http/ftp etc. library
  - libcmph (optional, also at http://sf.net/projects/cmph)
  - gccxml
  - gcc, binutils, make, ...

Package names in Debian:

	libgtk2.0-dev
	libffi4-dev
	liblua5.1-0-dev
	liblua5.1-expat0
	liblua5.1-bit0
	liblua5.1-socket-dev
	libcmph-dev
	gccxml
	gcc
	make

Thanks to Enrico Tassi for building all the Lua related packages, including
this one, and even the cmph library.


About the optional cmph library
-------------------------------

  This library can compute a minimal perfect hash function, which means that
for a given set of keys, each key is mapped to an integer in the range 0 to
n-1, n being the number of keys.  There are no hash collisions and no unused
slots.

  At runtime, cmph is not required.  lua-gtk contains the (simple) code to
do hash lookups; the code to compute the hash function is much more complex.

  If this library is not available at build time, a simple hash method is used
instead.  There is probably little runtime difference, both size and speed
wise, although I suppose the cmph generated hash will be faster; it requires
two hash values to be computed, but doesn't have collisions, while the simple
code needs just one hash computation, but has lots of collisions as well as
empty buckets.


Procedure
---------

 - optionally, run script/configure (try --help)
 - run "make"
 - as root, run "make install".  Alternatively, create symlinks which is
   nice during development:

   /usr/local/lib/lua/5.1/gtk.so --> ..../lua-gtk/build/linux-i386/gtk.so
   /usr/local/share/lua/5.1/gtk --> ..../lua-gtk/lib

Now you should be ready to run the example scripts:

$ lua examples/button.lua
$ lua examples/pixmap.lua



Documentation
=============

  The included documentation is partly built directly from the Lua and C
sources.  This requires an improved version of luadoc, not yet publicly
available, but I'm trying to get the changes into the official luadoc.



Build Instructions for MingW32
==============================

To build this package for Windows please use MingW32.  The resulting binaries
run on native Windows.  In other words, you'll be cross-compiling from Linux
to Windows; I don't have a development environment under Windows to build it
natively.  Therefore, install the mingw32 build environment, e.g. for Debian,
"apt-get install mingw32".



Step 1
------

  Please refer to README.win32.txt on instructions on how and where to get the
latest Gtk+2 libraries.  You need quite a few ZIP files for the individual
components.  To make this easier, use the provided script:

	mkdir -p mingw/gtk/zip
	script/download-gtk-win.lua -d mingw/gtk/zip
	cd mingw/gtk
	for i in zip/*.zip; do unzip $i; done

  Then install the Gtk runtime (not the -dev packages, just the normal ones)
onto a Windows box.  Again, see README.win32.txt on how to edit the registry
to add the install path to the search path.  It is possible to try it out with
wine, although the fonts are at a huge size, I haven't figured out why, YMMV.


Step 2
------

Build the library by calling

	make win32

This builds the file build/win32/gtk.dll.  The Makefile "remembers" which
platform you built for, so you don't have to specify win32 in subsequent
calls.  To obtain a ZIP file with all the required files, do this:

	make zip

This will create the tree /tmp/lua-gtk-$(VERSION), along with a suitable
ZIP file.  Copy that to the windows box, and try it out.



[1] http://luabinaries.luaforge.net/packaging.html,
    http://luabinaries.luaforge.net/download.html
    The file to get is lua...._Win32_bin.zip

